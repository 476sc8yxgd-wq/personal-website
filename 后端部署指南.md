# ğŸš€ åç«¯ä¸€é”®éƒ¨ç½²è„šæœ¬

## è¯´æ˜

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š
1. âœ… æ‰“åŒ…åç«¯æ‰€æœ‰æ–‡ä»¶
2. âœ… ä¸Šä¼ åˆ°æœåŠ¡å™¨
3. âœ… åœ¨æœåŠ¡å™¨ä¸Šæ„å»ºå’Œéƒ¨ç½²
4. âœ… é‡å¯æœåŠ¡
5. âœ… éªŒè¯éƒ¨ç½²çŠ¶æ€

## ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ Aï¼šè¿è¡Œ PowerShell è„šæœ¬ï¼ˆæ¨èï¼‰

1. **å³é”®ç‚¹å‡»** `deploy-backend-full.ps1`
2. é€‰æ‹© **"ä½¿ç”¨ PowerShell è¿è¡Œ"**
3. æˆ–è€…æ‰“å¼€ PowerShellï¼Œæ‰§è¡Œï¼š
   ```powershell
   cd "C:\Users\28945\Desktop\ä¸ªäººç½‘ç«™é‡åˆ¶ç‰ˆ"
   .\deploy-backend-full.ps1
   ```

4. **è¾“å…¥æœåŠ¡å™¨å¯†ç **ï¼ˆæ‚¨çš„è…¾è®¯äº‘æœåŠ¡å™¨å¯†ç ï¼‰

### æ–¹å¼ Bï¼šåˆ†æ­¥æ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¦‚æœè„šæœ¬å¤±è´¥ï¼‰

å¦‚æœ PowerShell è„šæœ¬å¤±è´¥ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨æ“ä½œï¼š

#### æ­¥éª¤ 1ï¼šç™»å½•å®å¡”é¢æ¿

- åœ°å€ï¼šhttps://43.138.3.207:20794/8ff1df99
- ç”¨æˆ·åï¼š`ede6tf5z`
- å¯†ç ï¼šæ‚¨çš„å®å¡”é¢æ¿å¯†ç 

#### æ­¥éª¤ 2ï¼šä¸Šä¼ åç«¯æ–‡ä»¶

åœ¨å®å¡”é¢æ¿çš„æ–‡ä»¶ç®¡ç†ä¸­ï¼š

1. è¿›å…¥ï¼š`/var/www/personal-website`
2. ä¸Šä¼ ä»¥ä¸‹æ–‡ä»¶ï¼ˆå¦‚æœå·²å­˜åœ¨åˆ™è¦†ç›–ï¼‰ï¼š
   - `Dockerfile` (ä»é¡¹ç›®æ ¹ç›®å½•ï¼‰
   - `docker-compose.yml` (ä»é¡¹ç›®æ ¹ç›®å½•ï¼‰
   - `backend/` (æ•´ä¸ªç›®å½•ï¼Œä»é¡¹ç›®æ ¹ç›®å½•ï¼‰

**ä¸Šä¼ æ–¹å¼ï¼š**
- å‹ç¼© `backend` ç›®å½•ä¸º `.zip`
- ä¸Šä¼ åè§£å‹
- æˆ–ç›´æ¥æ‹–æ‹½ä¸Šä¼ æ•´ä¸ªç›®å½•

#### æ­¥éª¤ 3ï¼šåœ¨å®å¡”ç»ˆç«¯æ‰§è¡Œéƒ¨ç½²å‘½ä»¤

1. åœ¨å®å¡”é¢æ¿å·¦ä¾§èœå•æ‰¾åˆ° **"ç»ˆç«¯"**
2. ç‚¹å‡»è¿›å…¥
3. æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /var/www/personal-website

# åœæ­¢æ—§å®¹å™¨
docker-compose down

# æ„å»ºæ–°é•œåƒ
docker-compose build --no-cache

# å¯åŠ¨å®¹å™¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

#### æ­¥éª¤ 4ï¼šéªŒè¯éƒ¨ç½²

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 3000
```

#### æ­¥éª¤ 5ï¼šæµ‹è¯•åç«¯ API

åœ¨æµè§ˆå™¨æˆ–å‘½ä»¤è¡Œä¸­æµ‹è¯•ï¼š

```bash
# å¥åº·æ£€æŸ¥
curl http://43.138.3.207:3000/health

# API å¥åº·æ£€æŸ¥
curl http://43.138.3.207:3000/api/health
```

## éƒ¨ç½²ç»“æ„

```
/var/www/personal-website/
â”œâ”€â”€ Dockerfile (æ–°ç‰ˆæœ¬ï¼‰
â”œâ”€â”€ docker-compose.yml (æ–°ç‰ˆæœ¬ï¼‰
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ server.ts
â”‚       â”œâ”€â”€ config/
â”‚       â”œâ”€â”€ controllers/
â”‚       â”œâ”€â”€ models/
â”‚       â”œâ”€â”€ routes/
â”‚       â”œâ”€â”€ types/
â”‚       â””â”€â”€ utils/
â”œâ”€â”€ public/ (å‰ç«¯é™æ€æ–‡ä»¶ï¼‰
â””â”€â”€ logs/ (æ—¥å¿—ç›®å½•ï¼‰
```

## Docker Compose é…ç½®

æ–°é…ç½®æ”¯æŒï¼š
- âœ… å‰ç«¯ç«¯å£ï¼š8008
- âœ… åç«¯ç«¯å£ï¼š3000
- âœ… Supabase é›†æˆ
- âœ… å¥åº·æ£€æŸ¥
- âœ… è‡ªåŠ¨é‡å¯

## ç¯å¢ƒå˜é‡

é…ç½®åœ¨ `docker-compose.yml` ä¸­ï¼š

```yaml
environment:
  - NODE_ENV=production
  - PORT=3000
  - SUPABASE_URL=https://assfhuxuglbootvpigeu.supabase.co
  - SUPABASE_ANON_KEY=eyJhbGci...
  - SUPABASE_SERVICE_KEY=eyJhbGci...
  - JWT_SECRET=your_jwt_secret_key_please_change_this_in_production_2025
  - JWT_EXPIRES_IN=7d
```

## å¸¸è§é—®é¢˜

### Q1: docker-compose build å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
ERROR: failed to solve: process "/bin/sh -c npm install" did not complete successfully
```

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ¸…ç†æ„å»ºç¼“å­˜
docker system prune -a

# é‡æ–°æ„å»º
docker-compose build --no-cache
```

### Q2: ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯ï¼š**
```
Error starting userland proxy: listen tcp 0.0.0.0:3000: bind: address already in use
```

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :3000
# æˆ–
ss -tlnp | grep 3000

# æ€æ­»è¿›ç¨‹
kill -9 <PID>

# é‡æ–°å¯åŠ¨
docker-compose up -d
```

### Q3: å®¹å™¨å¯åŠ¨å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
Container exited with code 1
```

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æŸ¥çœ‹æ—¥å¿—
docker-compose logs

# æ£€æŸ¥é…ç½®
docker-compose config
```

### Q4: å‰ç«¯æ— æ³•è®¿é—®åç«¯

**ç°è±¡ï¼š** å‰ç«¯é¡µé¢æ­£å¸¸ï¼Œä½† API è°ƒç”¨å¤±è´¥

**æ£€æŸ¥ï¼š**
```bash
# æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
docker ps

# æ£€æŸ¥ç«¯å£æ˜ å°„
docker port personal_website

# æµ‹è¯•åç«¯è¿é€šæ€§
curl http://localhost:3000/api/health
```

## éªŒè¯æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·ç¡®è®¤ï¼š

- [ ] Dockerfile å·²ä¸Šä¼ 
- [ ] docker-compose.yml å·²ä¸Šä¼ 
- [ ] backend/ ç›®å½•å·²ä¸Šä¼ 
- [ ] å®¹å™¨å·²é‡æ–°æ„å»º
- [ ] å®¹å™¨æ­£åœ¨è¿è¡Œ
- [ ] ç«¯å£ 3000 æ­£åœ¨ç›‘å¬
- [ ] ç«¯å£ 8008 æ­£åœ¨ç›‘å¬
- [ ] åç«¯ API å“åº”æ­£å¸¸
- [ ] å‰ç«¯å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] åšå®¢åŠŸèƒ½æ­£å¸¸
- [ ] é—®ç­”åŠŸèƒ½æ­£å¸¸

## è®¿é—®åœ°å€

éƒ¨ç½²æˆåŠŸåï¼š

- **å‰ç«¯:** http://43.138.3.207:8008
- **åç«¯ API:** http://43.138.3.207:3000
- **å¥åº·æ£€æŸ¥:** http://43.138.3.207:3000/health
- **API å¥åº·æ£€æŸ¥:** http://43.138.3.207:3000/api/health

## å¸¸ç”¨å‘½ä»¤

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /var/www/personal-website

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢æœåŠ¡
docker-compose stop

# å¯åŠ¨æœåŠ¡
docker-compose start

# é‡å»ºæœåŠ¡
docker-compose up -d --build
```

## æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. å®å¡”é¢æ¿æ—¥å¿—
2. Docker å®¹å™¨æ—¥å¿—ï¼š`docker-compose logs`
3. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

---

**é¢„è®¡å®Œæˆæ—¶é—´ï¼š** 5-10 åˆ†é’Ÿ
**æœ€åæ›´æ–°ï¼š** 2025-12-26
