# 宝塔面板部署 - 完整操作流程

## 📋 准备工作

已为您创建以下工具文件：
- `宝塔部署快速指南.md` - 快速操作指南
- `构建前端.bat` - 一键构建前端
- `宝塔面板部署方案.md` - 详细方案文档

---

## 🚀 部署流程（共8步）

### 步骤1：获取宝塔面板密码

打开PowerShell，执行：
```powershell
ssh root@43.138.3.207
```
密码：`Tencent@12345`

登录后执行：
```bash
bt 14
```

记录显示的password（密码）。

---

### 步骤2：本地构建前端

**方法A：双击运行（推荐）**

双击运行以下文件：
```
c:\Users\28945\Desktop\个人网站重制版\构建前端.bat
```

**方法B：手动执行**

在PowerShell中执行：
```powershell
cd c:\Users\28945\Desktop\个人网站重制版\frontend
npm install
npm run build
```

构建成功后，会打开 `dist` 目录。

---

### 步骤3：登录宝塔面板

在浏览器访问：
```
https://43.138.3.207:20794/8ff1df99
```

输入：
- 用户名：`ede6tf5z`
- 密码：步骤1获取的密码

---

### 步骤4：创建站点

1. 点击左侧 **"网站"** → **"添加站点"**

2. 填写配置：
   - **域名**：`43.138.3.207`
   - **根目录**：`/www/wwwroot/personal-website`
   - **FTP**：不创建
   - **数据库**：不创建
   - **PHP版本**：纯静态

3. 点击 **"提交"**

---

### 步骤5：上传前端文件

1. 点击左侧 **"文件"**

2. 进入 `/www/wwwroot/personal-website`

3. 删除默认文件：`index.html` 和 `404.html`

4. 点击 **"上传"**

5. 上传 `dist` 目录下的所有文件：
   ```
   c:\Users\28945\Desktop\个人网站重制版\frontend\dist
   ```
   需要上传的文件：
   - `index.html`
   - `assets/` （整个文件夹）
   - `vite.svg`

**上传提示**：
- 可以拖拽整个 `assets` 文件夹
- 确保所有JS和CSS文件都上传成功

---

### 步骤6：配置反向代理（API转发）

1. 点击左侧 **"网站"** → 找到你的站点 → 点击 **"设置"**

2. 点击左侧 **"反向代理"** → **"添加反向代理"**

3. 填写配置：
   - **代理名称**：`backend_api`
   - **目标URL**：`http://127.0.0.1:3001`
   - **发送域名**：`$host`
   - **代理目录**：`/api`

4. 点击 **"提交"**

**说明**：
- 这个配置会将前端的所有 `/api/*` 请求转发到后端Docker容器
- 后端容器已部署并运行在端口3001

---

### 步骤7：配置伪静态（支持React Router）

1. 点击左侧 **"网站"** → 找到你的站点 → 点击 **"设置"**

2. 点击左侧 **"伪静态"**

3. 输入以下规则：

```nginx
location / {
    try_files $uri $uri/ /index.html;
}
```

4. 点击 **"保存"**

**说明**：
- React Router使用前端路由，需要这个配置
- 配置后刷新页面不会出现404

---

### 步骤8：验证部署

访问网站：
```
http://43.138.3.207
```

**检查项**：
- ✅ 网站首页正常显示
- ✅ 导航栏所有链接可点击
- ✅ "关于我"页面显示新版本（双列布局+王者荣耀省标）
- ✅ 没有API错误（打开浏览器控制台检查，F12）

---

## 🔧 常见问题

### 问题1：无法登录宝塔面板

**解决**：
1. 检查地址是否正确：`https://43.138.3.207:20794/8ff1df99`
2. 确认用户名和密码正确
3. 如果密码不正确，SSH登录服务器执行 `bt 5` 修改密码

### 问题2：上传文件时提示"上传失败"

**解决**：
1. 分批上传文件（先上传index.html，再上传assets文件夹）
2. 或者先将文件打包成zip，上传后在服务器上解压

### 问题3：网站可以访问，但API请求失败

**原因**：反向代理未正确配置

**解决**：
1. 检查反向代理配置（步骤6）
2. 确认后端Docker容器正在运行：
   ```bash
   ssh root@43.138.3.207
   docker ps | grep personal_website_backend
   ```

### 问题4：刷新页面出现404

**原因**：伪静态规则未配置

**解决**：
按照步骤7配置伪静态规则

### 问题5：静态资源（JS/CSS）加载失败

**原因**：文件未正确上传

**解决**：
1. 检查 `/www/wwwroot/personal-website/assets/` 目录
2. 确保所有文件都已上传
3. 检查文件权限（应该为644）

---

## ✅ 部署完成检查清单

- [ ] 宝塔面板登录成功
- [ ] 前端构建成功
- [ ] 站点创建成功
- [ ] 所有文件上传成功
- [ ] 反向代理配置成功
- [ ] 伪静态规则配置成功
- [ ] 网站可正常访问
- [ ] API请求正常
- [ ] "关于我"页面显示新版本

---

## 🎯 预期效果

访问 `http://43.138.3.207` 后：

**首页**：
- 美观的导航栏
- 个人介绍卡片
- 博客文章列表
- 问答展示

**关于我页面**（重点检查）：
- ✅ 双列布局
- ✅ 渐变卡片头部（蓝色、紫色、绿色、橙粉色）
- ✅ 王者荣耀省标标签（省标雅典娜、省标不知火舞、省标大司命）
- ✅ "现任"时间标签
- ✅ 流畅的过渡动画

---

## 📞 需要帮助？

如果在部署过程中遇到问题：

1. 查看宝塔面板日志：左侧菜单 → 日志
2. 查看Nginx错误日志：`/www/wwwroot/站点目录/logs/`
3. 查看后端Docker日志：
   ```bash
   ssh root@43.138.3.207
   docker logs personal_website_backend
   ```

---

## 💡 提示

- 后端Docker容器继续运行，无需修改
- 宝塔面板只负责托管前端静态文件
- 反向代理将 `/api/*` 请求转发到后端
- 部署完成后，记得清除浏览器缓存

---

## 🚀 开始部署

现在开始执行上述步骤！

1. **首先执行**：双击运行 `构建前端.bat`
2. **然后**：按照步骤3-8完成宝塔面板配置

**有问题随时告诉我！** 😊
