# 前端文件上传指南

## 📦 需要上传的文件

**源目录**: `frontend/dist/`

**目标目录**: `/var/www/personal-website/public/`

**主要文件**:
- `index.html` - HTML 入口文件
- `assets/index-Bnmig0ZE.js` - 主 JavaScript 文件
- `assets/index-B4bKsMer.css` - 主样式文件
- `assets/*.js` - 其他 JavaScript 文件

## 🚀 上传方法

### 方法一：使用 PowerShell + SCP（推荐）

#### 步骤 1：安装 OpenSSH 客户端

Windows 10/11 自带 OpenSSH 客户端，检查是否已安装：

```powershell
# 检查是否安装
Get-WindowsCapability -Online | Where-Object Name -like 'OpenSSH.Client*'
```

如果未安装，使用以下命令安装：

```powershell
# 以管理员身份运行 PowerShell
Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0
```

#### 步骤 2：运行上传脚本

```powershell
# 在项目根目录运行
.\upload-to-server.ps1

# 如果遇到执行策略错误，先运行：
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

#### 步骤 3：输入密码

脚本会提示输入服务器密码，输入后自动上传。

---

### 方法二：使用 WinSCP（图形化工具）

#### 步骤 1：下载 WinSCP

访问：https://winscp.net/eng/download.php

#### 步骤 2：配置连接

1. 打开 WinSCP
2. 点击"新建站点"
3. 填写信息：
   - **文件协议**: SFTP
   - **主机名**: 43.138.3.207
   - **端口号**: 22
   - **用户名**: root（或您的用户名）
   - **密码**: 您的服务器密码
4. 点击"登录"

#### 步骤 3：上传文件

1. 左侧（本地）导航到: `c:/Users/28945/Desktop/个人网站重制版/frontend/dist/`
2. 右侧（远程）导航到: `/var/www/personal-website/public/`
3. 全选左侧文件，拖拽到右侧

#### 步骤 4：重启服务

使用 SSH 客户端（如 PuTTY）登录服务器，运行：

```bash
cd /var/www/personal-website
docker-compose restart
```

---

### 方法三：使用命令行（适用于 Mac/Linux）

```bash
# 上传文件
scp -r frontend/dist/* root@43.138.3.207:/var/www/personal-website/public/

# SSH 登录服务器
ssh root@43.138.3.207

# 重启服务
cd /var/www/personal-website
docker-compose restart
```

---

### 方法四：使用 FileZilla

#### 步骤 1：下载 FileZilla

访问：https://filezilla-project.org/download.php

#### 步骤 2：配置连接

1. 打开 FileZilla
2. 文件 -> 站点管理器 -> 新建站点
3. 填写信息：
   - **协议**: SFTP
   - **主机**: 43.138.3.207
   - **端口**: 22
   - **用户**: root
   - **密码**: 您的密码
4. 点击"连接"

#### 步骤 3：上传文件

1. 左侧（本地）导航到: `c:/Users/28945/Desktop/个人网站重制版/frontend/dist/`
2. 右侧（远程）导航到: `/var/www/personal-website/public/`
3. 全选左侧文件，拖拽到右侧

#### 步骤 4：重启服务

同方法二。

---

### 方法五：使用 PowerShell + WebRequest（需要服务器支持）

⚠️ 此方法需要在服务器上配置文件接收端，较复杂，不建议使用。

---

## ✅ 上传后验证

### 1. 检查文件是否上传成功

```bash
# SSH 登录服务器
ssh root@43.138.3.207

# 检查文件
docker exec -it personal_website ls -la /app/public/

# 应该看到以下文件：
# index.html
# assets/
#   index-Bnmig0ZE.js
#   index-B4bKsMer.css
#   其他 .js 文件
```

### 2. 重启服务

```bash
cd /var/www/personal-website
docker-compose restart
```

### 3. 访问网站

打开浏览器访问: http://43.138.3.207:8008

### 4. 检查浏览器控制台

1. 按 F12 打开开发者工具
2. 切换到 Console 标签
3. 检查是否有错误

应该看到:
- ✅ 没有 400 Bad Request 错误
- ✅ 没有 502 Bad Gateway 错误
- ✅ Supabase 查询正常

---

## 🎯 快速命令参考

```bash
# 查看容器状态
docker ps

# 查看容器日志
docker logs personal_website

# 实时查看日志
docker logs -f personal_website

# 重启服务
cd /var/www/personal-website
docker-compose restart

# 重建服务（如果代码有更新）
docker-compose up -d --build

# 进入容器
docker exec -it personal_website sh

# 在容器内查看文件
ls -la /app/public/
```

---

## 📞 常见问题

### Q1: 上传时提示"权限被拒绝"

**A**: 检查：
1. 服务器用户名和密码是否正确
2. 是否有 `/var/www/personal-website/public/` 目录的写权限

### Q2: 上传后网站还是旧版本

**A**: 执行以下命令清除浏览器缓存：
1. Ctrl + Shift + Delete
2. 清除缓存和 Cookie
3. 或者使用无痕模式访问

### Q3: 网站显示"请上传前端构建文件到 public 目录"

**A**: 说明前端文件未上传或上传路径错误，检查：
1. 文件是否上传到 `/var/www/personal-website/public/`
2. `index.html` 是否存在

### Q4: 浏览器控制台有 404 错误

**A**: 检查：
1. JS/CSS 文件是否正确上传
2. 文件路径是否正确（应该在 `assets/` 目录下）

---

## 📝 推荐流程

对于 Windows 用户，推荐使用 **方法一（PowerShell + SCP）** 或 **方法二（WinSCP）**：

1. 安装 OpenSSH 客户端（方法一）或 WinSCP（方法二）
2. 运行上传脚本或使用图形化工具上传文件
3. SSH 登录服务器重启服务
4. 浏览器访问验证

---

**上传时间**: 2025-12-25
**上传目标**: 43.138.3.207:/var/www/personal-website/public/
**下一步**: 选择上传方法并执行
